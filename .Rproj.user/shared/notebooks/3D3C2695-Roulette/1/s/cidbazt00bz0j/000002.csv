"0","one_play <- function(state){"
"0","  "
"0","    # Wager"
"0","    proposed_wager <- ifelse(state$previous_win, 1, 2*state$previous_wager)"
"0","    wager <- min(proposed_wager, state$M, state$B)"
"0","    "
"0","    # Spin of the wheel"
"0","    red <- rbinom(1,1,18/38)"
"0","    "
"0","    # Update state"
"0","    state$plays <- state$plays + 1"
"0","    state$previous_wager <- wager"
"0","    if(red){"
"0","      # WIN"
"0","      state$B <- state$B + wager"
"0","      state$previous_win <- TRUE"
"0","    }else{"
"0","      # LOSE"
"0","      state$B <- state$B - wager"
"0","      state$previous_win <- FALSE"
"0","    }"
"0","  state"
"0","}"
